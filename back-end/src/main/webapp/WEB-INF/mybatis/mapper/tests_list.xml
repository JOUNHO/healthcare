<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team4.healthcare.dao.TestDao">
	<select id="selectTestHistory" resultType="summeryTest">
		SELECT DATE_FORMAT(treatment_date, '%Y-%m-%d') as treatment_date, treatment.treatment_id, treatment.staff_id, staff.staff_name, tests_list.test_code, tests.test_name
		FROM treatment, staff, tests_list, tests
		where treatment.staff_id = staff.staff_id 
			and treatment.treatment_id = tests_list.treatment_id
    		and tests_list.test_code = tests.test_code
			and patient_id = #{patient_id}
	</select>
	<select id="selectTestsByAppointment" resultType="testlist">
		SELECT tests_list.test_list_id, tests_list.test_code, tests.test_name, treatment.staff_id, treatment.patient_id, patient.patient_name, tests_list.test_list_state
		FROM tests_list, tests, treatment, patient
		where tests_list.appointment_id=#{appointment_id}
		and tests_list.test_code = tests.test_code
        and tests_list.treatment_id = treatment.treatment_id
        and treatment.patient_id = patient.patient_id
	</select>
</mapper>